{% extends "base.html" %}
{% block title %} US Congress {% endblock %}

{% block links %}
<link href="{{MEDIA_URL}}media/css/us-congress.css" rel="stylesheet">
<script src="{{MEDIA_URL}}media/js/us-congress.js" type="text/javascript"></script>
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false" type="text/javascript"></script>
<script>
var tweetData={{congressArray|safe}};

	var map;
	function initialize() {
		var mapOptions = {
			zoom : 3,
			center : new google.maps.LatLng(41.835265, -87.622279),
			mapTypeId : google.maps.MapTypeId.ROADMAP
		};
		var latLng;
		var marker;

		map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
		for (var i = 0; i < tweetData.length; i++) {
          // var coords = results.features[i].geometry.coordinates;
          latLng = new google.maps.LatLng(parseFloat(tweetData[i][8]),parseFloat(tweetData[i][7]));
          var marker = new google.maps.Marker({
            position: latLng,
            title: tweetData[i][1],
            map: map
          });
          attachPopUpInfo(marker, i);
        }
	}


	google.maps.event.addDomListener(window, 'load', initialize);
	
	function attachPopUpInfo(marker, i){
		
          var infowindowContentString = '<div id="infoWindow">'+
				'<div id="example" class="">'+
					'<div class="tweeterific'+tweetData[i][0] +'" id="{{forloop.counter}}" style="display:none;">'+
						'<img width="40" height="40" src='+tweetData[i][3]+'>'+
						'<p class="text">'
							'<span class="username"><a href="http://twitter.com/#!/'+tweetData[i][4]+'">'+tweetData[i][1]+'</a>:</span>'+tweetData[i][2]+'<span ><a href='+tweetData[i][5]+'>'+tweetData[i][0]+'</a></span>'
						'</p></div></div></div>';
		 var tweetWindowContent= '<div id="content">'+
        '<img width="40" height="40" src='+tweetData[i][3]+'>'+
        '<b>'+'<span class="username"><a href="http://twitter.com/#!/'+tweetData[i][4]+'">'+tweetData[i][1]+'</a>:</span>' +'</b>'+
        '<p>'+ tweetData[i][2]+'</p>'+
        '<span><a href='+tweetData[i][5]+'>'+tweetData[i][0]+'</a></span>'+
        '</div>';
          var infowindow = new google.maps.InfoWindow({
          	 content: tweetWindowContent,
          	 size: new google.maps.Size(50,50)
          	 });
          google.maps.event.addListener(marker, 'click', function() {
          	infowindow.open(map,marker);
    		});
	} 
</script>
{% endblock %}
{% block javascript %}
max= {{ row|length }};{% endblock %}
{% block content %}

<div class="page-header" align="center">
	<h1>US Congress</h1>
</div>

<div class="container-fluid">
	<div class="row-fluid">
		<div align="center">
			<h4>Tweets</h4>
		</div>

		<div id="tweetbox" class="span8 offset2">
			{% for r in row %}

			<div id="container">
				<div id="example" class="tweets">
					<div class="tweet tweet-{{r.0}}" id="tweet-{{forloop.counter}}" style="display:none;">
						<img width="40" height="40" src={{r.3}}>
						<p class="text">
							<span class="username"><a href="http://twitter.com/#!/{{r.4}}">{{r.1}}</a>:</span> {{r.2}} <span class="time"><a href={{r.5	}}> {{r.0}} </a></span>
						</p>
					</div>
				</div>
			</div>
			{% endfor %}
			
		</div>
	</div>
	<br>
 
	<div class="row-fluid">
		<div class="span4">
			<div id="public-maps" class="well-large">
				<h3>Public</h3>
				<span><a href="#political-maps">Political Map</a></span>
				<br>
				Netowrk Map
				<br>
				Congress Map
				<br>
			</div>

		</div>
		<div class="span4">
			<div id="centerdiv" class="well-large">
				<h3>Public</h3>
				Find Your Representative
				<br>
				Trends
				<br>
				Networks
				<br>
			</div>

		</div>
		<div class="span4">
			<div id="public-maps" class="well-large">
				<h3>Research</h3>
				Data Retrieved
				<br>
				Request Information
				<br>
			</div>
		</div>
	</div>
<br><br>

<div class="page-header" align="center" id="political-maps">
	<h1>Political Maps</h1>
</div>
	<div class="row-fluid">
		<div class="well-large">
			<div class="span4 offset3">
				<div id="map-canvas"></div>
			</div>
		</div>
	</div>

</div>

{% endblock %}
